<h1>About</h1>
<p>wcm2022</p>
<p>四設計一甲 410231104 呂佳柔</p>
<p>下學期選課 網際內容管理</p>
<h1>Online</h1>
<h2>w13</h2>
<p>2022/5/20</p>
<p><span>在個人動態與靜態網頁中配置 Brython 程式環境, 並啟動執行線上程式</span></p>
<p><span>執行結果</span></p>
<!-- 導入 brython 程式庫 -->
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
<!-- 啟動 Brython -->
<script>
window.onload=function(){
brython({debug:1, pythonpath:['/static/','./../downloads/py/']});
}
</script>
<div id="brython_div"></div>
<script type="text/python">
# from https://levelup.gitconnected.com/writing-tetris-in-python-2a16bddb5318
# 暫時關閉 system proxy 設定後,  pip install pygame
#import pygame
import random
# 以下為 Brython 新增
from browser import document as doc
from browser import html
import browser.timer

# 利用 html 建立一個 CANVAS 標註物件, 與變數 canvas 對應
canvas = html.CANVAS(width = 400, height = 500, id="canvas")
brython_div = doc["brython_div"]
brython_div <= canvas
ctx = canvas.getContext("2d")

colors = [
    (0, 0, 0),
    (120, 37, 179),
    (100, 179, 179),
    (80, 34, 22),
    (80, 134, 22),
    (180, 34, 22),
    (180, 34, 122),
]


class Figure:
    x = 0
    y = 0

    figures = [
        [[1, 5, 9, 13], [4, 5, 6, 7]],
        [[4, 5, 9, 10], [2, 6, 5, 9]],
        [[6, 7, 9, 10], [1, 5, 6, 10]],
        [[1, 2, 5, 9], [0, 4, 5, 6], [1, 5, 9, 8], [4, 5, 6, 10]],
        [[1, 2, 6, 10], [5, 6, 7, 9], [2, 6, 10, 11], [3, 5, 6, 7]],
        [[1, 4, 5, 6], [1, 4, 5, 9], [4, 5, 6, 9], [1, 5, 6, 9]],
        [[1, 2, 5, 6]],
    ]

    def __init__(self, x, y):
        self.x = x
        self.y = y
        self.type = random.randint(0, len(self.figures) - 1)
        self.color = random.randint(1, len(colors) - 1)
        self.rotation = 0

    def image(self):
        return self.figures[self.type][self.rotation]

    def rotate(self):
        self.rotation = (self.rotation + 1) % len(self.figures[self.type])


class Tetris:
    level = 2
    score = 0
    state = "start"
    field = []
    height = 0
    width = 0
    x = 100
    y = 60
    zoom = 20
    figure = None

    def __init__(self, height, width):
        self.height = height
        self.width = width
        self.field = []
        self.score = 0
        self.state = "start"
        for i in range(height):
            new_line = []
            for j in range(width):
                # 起始時每一個都填入 0
                new_line.append(0)
            self.field.append(new_line)

    def new_figure(self):
        self.figure = Figure(3, 0)

    def intersects(self):
        intersection = False
        for i in range(4):
            for j in range(4):
                if i * 4 + j in self.figure.image():
                    # block 到達底部, 左右兩邊界, 或該座標有其他 block
                    if i + self.figure.y > self.height - 1 or \
                            j + self.figure.x > self.width - 1 or \
                            j + self.figure.x < 0 or \
                            self.field[i + self.figure.y][j + self.figure.x] > 0:
                        intersection = True
        return intersection

    def break_lines(self):
        lines = 0
        for i in range(1, self.height):
            zeros = 0
            for j in range(self.width):
                if self.field[i][j] == 0:
                    zeros += 1
            if zeros == 0:
                lines += 1
                for i1 in range(i, 1, -1):
                    for j in range(self.width):
                        self.field[i1][j] = self.field[i1 - 1][j]
        self.score += lines ** 2

    def go_space(self):
        while not self.intersects():
            self.figure.y += 1
        self.figure.y -= 1
        self.freeze()

    def go_down(self):
        self.figure.y += 1
        if self.intersects():
            self.figure.y -= 1
            self.freeze()

    def freeze(self):
        for i in range(4):
            for j in range(4):
                if i * 4 + j in self.figure.image():
                    self.field[i + self.figure.y][j + self.figure.x] = self.figure.color
        self.break_lines()
        self.new_figure()
        if self.intersects():
            self.state = "gameover"

    def go_side(self, dx):
        old_x = self.figure.x
        self.figure.x += dx
        if self.intersects():
            self.figure.x = old_x

    def rotate(self):
        old_rotation = self.figure.rotation
        self.figure.rotate()
        if self.intersects():
            self.figure.rotation = old_rotation

# Define some colors
# from https://stackoverflow.com/questions/3380726/converting-a-rgb-color-tuple-to-a-six-digit-code
BLACK = '#%02x%02x%02x' % (0, 0, 0)
WHITE = '#%02x%02x%02x' % (255, 255, 255)
GRAY = '#%02x%02x%02x' % (128, 128, 128)

done = False
fps = 25
game = Tetris(20, 10)
counter = 0

pressing_down = False

def key_down(eve):
    key = eve.keyCode
    #if event.type == pygame.QUIT:
    # 32 is pause
    if key == 32:
        done = True
    # 82 is r key to rotate
    if key == 82:
        game.rotate()
    # 40 is down key
    if key == 40:
        pressing_down = True
    # 37 is left key
    if key == 37:
        game.go_side(-1)
    # 39 is right key
    if key == 39:
        game.go_side(1)
    # 68 is d key to move block to bottom
    if key == 68:
        game.go_space()
    # 27 is escape
    # reset the game
    if key == 27:
        game.__init__(20, 10)

def key_up(eve):
    key = eve.keyCode
    # 40 is down key
    if key == 40:
        pressing_down = False

#while not done:
def do_game():
    global counter
    if game.figure is None:
        game.new_figure()
    counter += 1
    if counter > 100000:
        counter = 0
    if counter % (fps // game.level // 2) == 0 or pressing_down:
        if game.state == "start":
            game.go_down()
    
    for i in range(game.height):
        for j in range(game.width):
            ctx.fillStyle = WHITE
            #ctx.scale(game.zoom, game.zoom)
            ctx.fillRect(game.x + game.zoom * j, game.y + game.zoom * i, game.zoom, game.zoom)
            if game.field[i][j] > 0:
                ctx.fillStyle = '#%02x%02x%02x' % colors[game.field[i][j]]
                ctx.fillRect(game.x + game.zoom * j + 1, game.y + game.zoom * i + 1, game.zoom - 2, game.zoom - 1)
            ctx.lineWidth = 1
            ctx.strokeStyle = GRAY
            ctx.beginPath()
            ctx.rect(game.x + game.zoom * j, game.y + game.zoom * i, game.zoom, game.zoom)
            ctx.stroke()
    if game.figure is not None:
        for i in range(4):
            for j in range(4):
                p = i * 4 + j
                if p in game.figure.image():
                    ctx.fillStyle = '#%02x%02x%02x' % colors[game.figure.color]
                    ctx.fillRect(game.x + game.zoom * (j + game.figure.x) + 1,
                                      game.y + game.zoom * (i + game.figure.y) + 1,
                                      game.zoom - 2, game.zoom - 2)

doc.addEventListener("keydown", key_down)
doc.addEventListener("keyup", key_up)
browser.timer.set_interval(do_game, fps)
</script>
<h1>Midterm Exam</h1>
<p>題目1.如何設定nginx，讓其中所伺服的檔案只允許系上電腦下載。</p>
<p>解答:</p>
<ol>
<li>學校電腦網頁輸入 wcm.cycu.org:88</li>
<li>下載 nginx-1.20.2.zip 並解壓縮</li>
<li>nginx資料夾中拉出 nginx.cof</li>
<li>輸入 
<div class="line number1 index0 alt2"><code class="js plain"></code></div>
<img alt="" height="205" src="/images/螢幕擷取畫面 2022-04-15 114243.png" width="352"/></li>
<li><code class="js plain">save</code></li>
<li><code class="js plain">管理員身分執行nginx</code></li>
<li><span face="monospace" style="font-family: monospace;">cmd輸入ipconfig</span></li>
<li><span face="monospace" style="font-family: monospace;">複製IPv6位址，在網頁中貼上網址，前後加上[]，最後:</span></li>
<li><span face="monospace" style="font-family: monospace;"><span face="monospace" style="font-family: monospace;">網站顯示 <strong>Welcome to nginx!</strong></span></span></li>
</ol>
<p>題目2.如何利用gpg4win查驗所下載的<span>nfginx檔案與官方網站所附的數位簽章吻合。</span></p>
<p><span>解答</span></p>
<h1>midterm</h1>
<script>
var winkVideoData = {
  dataVersion: 1,
  frameRate: 10,
  buttonFrameLength: 5,
  buttonFrameOffset: 2,
  frameStops: {
  },
};
</script>
<div class="winkVideoContainerClass"><video autoplay="autoplay" class="winkVideoClass" controls="controls" data-dirname="/static" data-varname="winkVideoData" height="630" muted="true" width="1008">
<source src="/downloads/w8_project 1.mp4" type="video/mp4"/></video>
<div class="winkVideoOverlayClass"></div>
<div class="winkVideoControlBarClass"><button class="winkVideoControlBarPlayButtonClass"></button> <button class="winkVideoControlBarPauseButtonClass"></button>
<div class="winkVideoControlBarProgressLeftClass"></div>
<div class="winkVideoControlBarProgressEmptyMiddleClass"></div>
<div class="winkVideoControlBarProgressRightClass"></div>
</div>
</div>
<p>如何在網頁放上wink影片?</p>
<p>1. 下載轉檔程式ffmpeg.exe</p>
<p>2. 將影片存至downloads下</p>
<p>3. wink中按<span style="background-color: #ccffcc;">render</span>匯出轉檔</p>
<p>4. 到<a href="https://mde.tw/wcm2022_guide/content/PME.html">https://mde.tw/wcm2022_guide/content/PME.html</a> 下載w4_diff_note.txt</p>
<p>5. 於網頁程式碼中貼上/downloads/winkvideo</p>
<p>6. 程式碼中winkVideoData後的項目數字需相同</p>
<p>7. "/downloads/<span style="background-color: #ffff99;">w8_project 1.mp4</span>"改成正確檔案名稱</p>
<p>8. save</p>
<h1>cadlab server</h1>
<p>2022/5/13</p>
<p>1. 利用cadlab中沒有啟動還原保護的電腦磁區練習安裝server利用</p>
<p>2. 利用ping指令，測試是否可以經由NAT連線到系上網路連外的C:\Users\cadlab&gt;ping -t 140.130.17.254</p>
<p>3. 找到組別對應主機7-3(wcmg5)-<span style="color: #0000ff;">192.168.1.173</span></p>
<p><span style="color: #000000;">4. 網路連線&gt;乙太網路&gt;內容&gt;IPv4&gt;IP位址更改為 <span>192.168.1.173&gt;DNS伺服器位址 168.95.1.1</span></span></p>
<p><span style="color: #000000;"><span>5. 確定電腦可以連外後，到網址 wcm.cycu.org:88上下載設定網際內容管理伺服器所需要的程式檔案</span></span>可攜系統portable_python_wcm2022和nginx-1.20.2</p>
<p>6. 搜尋Nssm，進入網站Download下載nssm 2.24(64-bit)，為了將之後設定的伺服器能轉為電腦操作系統對應的服務</p>
<p>7. 三個下載的程式檔案分別解壓縮至 C槽&gt;使用者&gt;cadlab&gt;wcm2022ag5(組別對應目錄)</p>
<p>8. 打開cmd，以系統管理員身分執行nssm將nginx內建轉為操作系統中的service</p>
<p>9. C:\Users\cadlab\wcm2022ag5&gt;nssm install nginx</p>
<p>10. 執行後跳出nginx服務設定表單的視窗，路徑Path填入執行路徑 <span>Users\cadlab\wcm2022ag5\nginx-</span><span>1.20.2\nginx.exe</span></p>
<p><span>11. Service name輸入nginx，確認後按下Install service</span></p>
<p><span>12. Win10開始&gt;電腦管理&gt;服務與應用程式&gt;開啟nginx服務&gt;確認顯示"執行中"</span></p>
<p><span>13. 網頁輸入 192.168.1.173，利用瀏覽器連接，顯示出內建設定，<strong>Welcome to nginx!</strong></span></p>
<h1>Tetris 線上遊戲專案報告</h1>
<p><strong><span>&lt;h2&gt;w13&lt;/h2&gt;</span></strong></p>
<p><strong><span> </span></strong><strong><span>&lt;!-- </span></strong><strong>導入<span> brython </span></strong><strong>程式庫<span> --&gt;</span></strong></p>
<p><strong><span>&lt;script src="/static/brython.js"&gt;&lt;/script&gt;</span></strong></p>
<p><strong><span>&lt;script src="/static/brython_stdlib.js"&gt;&lt;/script&gt;</span></strong></p>
<p><span style="background-color: #ffff99;">#</span><span style="background-color: #ffff99;">將cmsimde&gt;</span><span style="background-color: #ffff99;">static&gt;brython.js和brython_stdlib.js(brython主程式及標準程式庫)導入。</span></p>
<p><span style="background-color: #ffff99;"><img alt="" height="265" src="/images/導入brython程式庫.png" width="498"/></span></p>
<p><strong><span>&lt;!-- </span></strong><strong>啟動 <span>Brython --&gt;</span></strong></p>
<p><strong><span>&lt;script&gt;</span></strong></p>
<p><strong><span>window.onload=function(){brython();} </span></strong></p>
<p><strong><span>&lt;/script&gt;</span></strong></p>
<p><span style="background-color: #ffff99;">#window.onload=function()使頁面加載完後立即執行{}裡的動作，即啟動Brython。</span></p>